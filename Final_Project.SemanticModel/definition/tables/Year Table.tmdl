table 'Year Table'
	lineageTag: e2497f52-966d-472f-bd72-80cf3576207e

	column Year
		dataType: int64
		formatString: 0
		lineageTag: bfdbceda-9526-499d-812e-418d1f75b4b5
		summarizeBy: none
		sourceColumn: Year

		annotation SummarizationSetBy = Automatic

	partition 'Year Table' = m
		mode: import
		source =
				let
				    Source = Csv.Document(File.Contents("C:\Users\roban\projects\SEIS632\Project 2\datasets\GDP by Country 1999-2022.csv"),[Delimiter=",", Columns=24, Encoding=65001, QuoteStyle=QuoteStyle.None]),
				    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
				    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"1999", type number}, {"2000", type number}, {"2001", type number}, {"2002", type number}, {"2003", type number}, {"2004", type number}, {"2005", type number}, {"2006", type number}, {"2007", type number}, {"2008", type number}, {"2009", type number}, {"2010", type number}, {"2012", type number}, {"2013", type number}, {"2014", type number}, {"2015", type number}, {"2016", type number}, {"2017", type number}, {"2018", type number}, {"2019", type number}, {"2020", type number}, {"2021", type number}, {"2022", type number}}),
				    #"Unpivoted Other Columns" = Table.UnpivotOtherColumns(#"Changed Type", {"Country"}, "Attribute", "Value"),
				    #"Changed Type1" = Table.TransformColumnTypes(#"Unpivoted Other Columns",{{"Attribute", type date}}),
				    #"Extracted Year" = Table.TransformColumns(#"Changed Type1",{{"Attribute", Date.Year, Int64.Type}}),
				    #"Renamed Columns" = Table.RenameColumns(#"Extracted Year",{{"Attribute", "Year"}, {"Value", "GDP"}}),
				    #"Removed Blank Rows" = Table.SelectRows(#"Renamed Columns", each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))),
				    #"Replaced Value" = Table.ReplaceValue(#"Removed Blank Rows","Afghanistan, Rep. of.","Afghanistan",Replacer.ReplaceText,{"Country"}),
				    #"Run Python script" = Python.Execute("import pandas as pd#(lf)import numpy as np#(lf)#(lf)# 'dataset' is the current table in Power Query#(lf)# Get unique years from current table#(lf)year_table = pd.DataFrame({#(lf)    'Year': sorted(dataset['Year'].unique())#(lf)})#(lf)#(lf)# Set data type to Int64 (ensures Power BI recognizes it as Whole Number)#(lf)year_table['Year'] = year_table['Year'].astype('int64')#(lf)#(lf)# Return the new dataframe#(lf)year_table",[dataset=#"Replaced Value"]),
				    year_table = #"Run Python script"{[Name="year_table"]}[Value],
				    #"Changed Type2" = Table.TransformColumnTypes(year_table,{{"Year", Int64.Type}}),
				    #"Appended Query" = Table.Combine({#"Changed Type2", #"Internet Usage by Country"}),
				    #"Removed Columns" = Table.RemoveColumns(#"Appended Query",{"Country", "Code", "Cellular Subscription", "Internet Users(%)", "No. of Internet Users", "Broadband Subscription"}),
				    #"Removed Duplicates" = Table.Distinct(#"Removed Columns")
				in
				    #"Removed Duplicates"

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

