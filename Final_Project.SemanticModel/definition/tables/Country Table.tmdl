table 'Country Table'
	lineageTag: cee5927e-a411-4d7e-8bd5-7dc65219ee27

	measure 'Country Count' = DISTINCTCOUNT('Country Table'[Country])
		formatString: 0
		lineageTag: 4b2800cd-1fe6-4002-8a88-9866b96b0f0c

	column Country
		dataType: string
		lineageTag: 7811ca28-f427-4a51-8ce9-d6e0d2bc39f0
		summarizeBy: none
		sourceColumn: Country

		annotation SummarizationSetBy = Automatic

	partition 'Country Table' = m
		mode: import
		source =
				let
				    Source = Csv.Document(File.Contents("C:\Users\roban\projects\SEIS632\Project 2\datasets\GDP by Country 1999-2022.csv"),[Delimiter=",", Columns=24, Encoding=65001, QuoteStyle=QuoteStyle.None]),
				    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
				    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"1999", type number}, {"2000", type number}, {"2001", type number}, {"2002", type number}, {"2003", type number}, {"2004", type number}, {"2005", type number}, {"2006", type number}, {"2007", type number}, {"2008", type number}, {"2009", type number}, {"2010", type number}, {"2012", type number}, {"2013", type number}, {"2014", type number}, {"2015", type number}, {"2016", type number}, {"2017", type number}, {"2018", type number}, {"2019", type number}, {"2020", type number}, {"2021", type number}, {"2022", type number}}),
				    #"Unpivoted Other Columns" = Table.UnpivotOtherColumns(#"Changed Type", {"Country"}, "Attribute", "Value"),
				    #"Changed Type1" = Table.TransformColumnTypes(#"Unpivoted Other Columns",{{"Attribute", type date}}),
				    #"Extracted Year" = Table.TransformColumns(#"Changed Type1",{{"Attribute", Date.Year, Int64.Type}}),
				    #"Renamed Columns" = Table.RenameColumns(#"Extracted Year",{{"Attribute", "Year"}, {"Value", "GDP"}}),
				    #"Removed Blank Rows" = Table.SelectRows(#"Renamed Columns", each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))),
				    #"Replaced Value" = Table.ReplaceValue(#"Removed Blank Rows","Afghanistan, Rep. of.","Afghanistan",Replacer.ReplaceText,{"Country"}),
				    #"Run Python script" = Python.Execute("import pandas as pd#(lf)import numpy as np#(lf)#(lf)# 'dataset' is the current table in Power Query#(lf)# Get unique Country from current table#(lf)country_table = pd.DataFrame({#(lf)    'Country': sorted(dataset['Country'].unique())#(lf)})#(lf)#(lf)# Return the new dataframe#(lf)country_table",[dataset=#"Replaced Value"]),
				    country_table = #"Run Python script"{[Name="country_table"]}[Value],
				    #"Appended Query" = Table.Combine({country_table, InternetUsage}),
				    #"Removed Columns" = Table.RemoveColumns(#"Appended Query",{"Code", "Year", "Cellular Subscription", "Internet Users(%)", "No. of Internet Users", "Broadband Subscription"}),
				    #"Removed Duplicates" = Table.Distinct(#"Removed Columns"),
				    #"Filtered Rows" = Table.SelectRows(#"Removed Duplicates", each ([Country] <> "World"))
				in
				    #"Filtered Rows"

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

